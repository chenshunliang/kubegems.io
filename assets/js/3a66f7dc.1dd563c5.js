"use strict";(self.webpackChunkkubegems_docs=self.webpackChunkkubegems_docs||[]).push([[5391],{3905:function(e,t,n){n.d(t,{Zo:function(){return p},kt:function(){return m}});var a=n(67294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var s=a.createContext({}),d=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},p=function(e){var t=d(e.components);return a.createElement(s.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},c=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,o=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),c=d(n),m=i,k=c["".concat(s,".").concat(m)]||c[m]||u[m]||o;return n?a.createElement(k,r(r({ref:t},p),{},{components:n})):a.createElement(k,r({ref:t},p))}));function m(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var o=n.length,r=new Array(o);r[0]=c;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:i,r[1]=l;for(var d=2;d<o;d++)r[d]=n[d];return a.createElement.apply(null,r)}return a.createElement.apply(null,n)}c.displayName="MDXCreateElement"},44531:function(e,t,n){n.r(t),n.d(t,{assets:function(){return p},contentTitle:function(){return s},default:function(){return m},frontMatter:function(){return l},metadata:function(){return d},toc:function(){return u}});var a=n(87462),i=n(63366),o=(n(67294),n(3905)),r=["components"],l={title:"Kind",hide_title:!0,sidebar_position:2},s=void 0,d={unversionedId:"installation/kubernetes-installation/kind",id:"installation/kubernetes-installation/kind",title:"Kind",description:"\u4f7f\u7528Kind\u5b89\u88c5",source:"@site/docs/installation/kubernetes-installation/kind.md",sourceDirName:"installation/kubernetes-installation",slug:"/installation/kubernetes-installation/kind",permalink:"/kubegems.io/docs/installation/kubernetes-installation/kind",tags:[],version:"current",sidebarPosition:2,frontMatter:{title:"Kind",hide_title:!0,sidebar_position:2},sidebar:"tutorialSidebar",previous:{title:"Kubeadm\uff08\u96c6\u7fa4\u6a21\u5f0f\uff09",permalink:"/kubegems.io/docs/installation/kubernetes-installation/kubeadm"},next:{title:"\u963f\u91cc\u4e91\uff08ASK\uff09",permalink:"/kubegems.io/docs/installation/kubernetes-installation/aks"}},p={},u=[{value:"\u4f7f\u7528Kind\u5b89\u88c5",id:"\u4f7f\u7528kind\u5b89\u88c5",level:2},{value:"Installation",id:"installation",level:3},{value:"Creating a Cluster",id:"creating-a-cluster",level:3},{value:"Interacting With Your Cluster",id:"interacting-with-your-cluster",level:3},{value:"Deleting a Cluster",id:"deleting-a-cluster",level:3},{value:"Loading an Image Into Your Cluster",id:"loading-an-image-into-your-cluster",level:3},{value:"Building Images",id:"building-images",level:3},{value:"Settings for Docker Desktop",id:"settings-for-docker-desktop",level:3},{value:"Advanced",id:"advanced",level:3},{value:"Configuring Your kind Cluster",id:"configuring-your-kind-cluster",level:4},{value:"Enable Feature Gates in Your Cluster",id:"enable-feature-gates-in-your-cluster",level:4},{value:"Configure kind to use a proxy",id:"configure-kind-to-use-a-proxy",level:3},{value:"Exporting Cluster Logs",id:"exporting-cluster-logs",level:3},{value:"reference",id:"reference",level:3}],c={toc:u};function m(e){var t=e.components,n=(0,i.Z)(e,r);return(0,o.kt)("wrapper",(0,a.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h2",{id:"\u4f7f\u7528kind\u5b89\u88c5"},"\u4f7f\u7528Kind\u5b89\u88c5"),(0,o.kt)("hr",null),(0,o.kt)("p",null,'kind\u662f\u4e00\u4e2a\u4f7f\u7528Docker\u5bb9\u5668 "\u8282\u70b9 "\u8fd0\u884c\u672c\u5730Kubernetes\u96c6\u7fa4\u7684\u5de5\u5177\u3002kind\u4e3b\u8981\u662f\u4e3a\u6d4b\u8bd5Kubernetes\u672c\u8eab\u800c\u8bbe\u8ba1\uff0c\u4f46\u4e5f\u53ef\u7528\u4e8e\u672c\u5730\u5f00\u53d1\u6216CI\u3002'),(0,o.kt)("p",null,"\u672c\u6587\u901a\u8fc7\u4ecb\u7ecdkind\u7684\u5b98\u65b9\u6587\u6863\uff0c\u6307\u5bfc\u7528\u6237\u5728\u672c\u5730\u73af\u5883\u5feb\u901f\u542f\u52a8\u4e00\u4e2a\u539f\u751f\u7684kubernetes\u670d\u52a1\u3002"),(0,o.kt)("h3",{id:"installation"},"Installation"),(0,o.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"\u4fe1\u606f")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},(0,o.kt)("inlineCode",{parentName:"p"},"kind")," does not require ",(0,o.kt)("a",{parentName:"p",href:"https://kubernetes.io/docs/reference/kubectl/overview/"},(0,o.kt)("inlineCode",{parentName:"a"},"kubectl")),",",(0,o.kt)("br",null),"\nbut you will not be able to perform some of the examples in our docs without it.",(0,o.kt)("br",null),"\nTo install ",(0,o.kt)("inlineCode",{parentName:"p"},"kubectl")," see the upstream ",(0,o.kt)("a",{parentName:"p",href:"https://kubernetes.io/docs/tasks/tools/install-kubectl/"},"kubectl installation docs"),"."))),(0,o.kt)("p",null,"You can either install kind with ",(0,o.kt)("inlineCode",{parentName:"p"},'GO111MODULE="on" go get sigs.k8s.io/kind@stableVersion')," or clone this repo\nand run ",(0,o.kt)("strong",{parentName:"p"},"make build")," from the repository."),(0,o.kt)("p",null,"Please use the latest Go when installing KIND from source, ideally go 1.14 or greater."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"go get")," will put ",(0,o.kt)("strong",{parentName:"p"},"kind")," in ",(0,o.kt)("inlineCode",{parentName:"p"},"$(go env GOPATH)/bin"),". You may need to add that directory to your ",(0,o.kt)("inlineCode",{parentName:"p"},"$PATH")," as\nshown ",(0,o.kt)("a",{parentName:"p",href:"https://golang.org/doc/code.html#GOPATH"},"here")," if you encounter the error\n",(0,o.kt)("inlineCode",{parentName:"p"},"kind: command not found")," after installation."),(0,o.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"\u4fe1\u606f")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},(0,o.kt)("strong",{parentName:"p"},"NOTE"),": ",(0,o.kt)("inlineCode",{parentName:"p"},"go get")," should not be run from a Go ","[modules]"," enabled project directory,",(0,o.kt)("br",null),"\nas go get inside a modules enabled project updates dependencies / behaves differently. Try for example ",(0,o.kt)("inlineCode",{parentName:"p"},"cd $HOME")," first."))),(0,o.kt)("p",null,"Without installing Go, kind can be built reproducibly with docker using ",(0,o.kt)("strong",{parentName:"p"},"make build"),",\nthe binary will be in ",(0,o.kt)("strong",{parentName:"p"},"bin/kind"),"."),(0,o.kt)("p",null,"Stable binaries are also available on the ","[releases]",' page.\nStable releases are generally recommended for CI usage in particular.\nTo install, download the binary for your platform from "Assets" and place this\ninto your ',(0,o.kt)("inlineCode",{parentName:"p"},"$PATH"),"."),(0,o.kt)("p",null,"On Linux:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"curl -Lo ./kind https://kind.sigs.k8s.io/dl/{{< stableVersion >}}/kind-linux-amd64\nchmod +x ./kind\nmv ./kind /some-dir-in-your-PATH/kind\n")),(0,o.kt)("p",null,"On macOS via Homebrew:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"brew install kind\n")),(0,o.kt)("p",null,"On macOS via MacPorts:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"sudo port selfupdate && sudo port install kind\n")),(0,o.kt)("p",null,"On macOS via Bash:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"curl -Lo ./kind https://kind.sigs.k8s.io/dl/{{< stableVersion >}}/kind-darwin-amd64\nchmod +x ./kind\nmv ./kind /some-dir-in-your-PATH/kind\n")),(0,o.kt)("p",null,"On Windows:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"curl.exe -Lo kind-windows-amd64.exe https://kind.sigs.k8s.io/dl/{{< stableVersion >}}/kind-windows-amd64\nMove-Item .\\kind-windows-amd64.exe c:\\some-dir-in-your-PATH\\kind.exe\n")),(0,o.kt)("p",null,"On Windows via Chocolatey (",(0,o.kt)("a",{parentName:"p",href:"https://chocolatey.org/packages/kind"},"https://chocolatey.org/packages/kind"),")"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"choco install kind\n")),(0,o.kt)("h3",{id:"creating-a-cluster"},"Creating a Cluster"),(0,o.kt)("p",null,"Creating a Kubernetes cluster is as simple as ",(0,o.kt)("inlineCode",{parentName:"p"},"kind create cluster"),"."),(0,o.kt)("p",null,"This will bootstrap a Kubernetes cluster using a pre-built\n","[node image][node image]",". Prebuilt images are hosted at","[",(0,o.kt)("inlineCode",{parentName:"p"},"kindest/node"),"][kindest/node]",", but to find images suitable for a given release currently you should check the ","[release notes]"," for your given kind version (check with ",(0,o.kt)("inlineCode",{parentName:"p"},"kind version"),") where\nyou'll find a complete listing of images created for a kind release."),(0,o.kt)("p",null,"To specify another image use the ",(0,o.kt)("inlineCode",{parentName:"p"},"--image")," flag -- ",(0,o.kt)("inlineCode",{parentName:"p"},"kind create cluster --image=..."),"."),(0,o.kt)("p",null,"Using a different image allows you to change the Kubernetes version of the created\ncluster."),(0,o.kt)("p",null,"If you desire to build the node image yourself with a custom version see the\n",(0,o.kt)("a",{parentName:"p",href:"#building-images"},"building images")," section."),(0,o.kt)("p",null,"By default, the cluster will be given the name ",(0,o.kt)("inlineCode",{parentName:"p"},"kind"),".\nUse the ",(0,o.kt)("inlineCode",{parentName:"p"},"--name")," flag to assign the cluster a different context name."),(0,o.kt)("p",null,"If you want the ",(0,o.kt)("inlineCode",{parentName:"p"},"create cluster")," command to block until the control plane\nreaches a ready status, you can use the ",(0,o.kt)("inlineCode",{parentName:"p"},"--wait")," flag and specify a timeout.\nTo use ",(0,o.kt)("inlineCode",{parentName:"p"},"--wait")," you must specify the units of the time to wait. For example, to\nwait for 30 seconds, do ",(0,o.kt)("inlineCode",{parentName:"p"},"--wait 30s"),", for 5 minutes do ",(0,o.kt)("inlineCode",{parentName:"p"},"--wait 5m"),", etc."),(0,o.kt)("p",null,"More usage can be discovered with ",(0,o.kt)("inlineCode",{parentName:"p"},"kind create cluster --help"),"."),(0,o.kt)("h3",{id:"interacting-with-your-cluster"},"Interacting With Your Cluster"),(0,o.kt)("p",null,"After ",(0,o.kt)("a",{parentName:"p",href:"#creating-a-cluster"},"creating a cluster"),", you can use ","[kubectl][kubectl]","\nto interact with it by using the ","[configuration file generated by kind][access multiple clusters]","."),(0,o.kt)("p",null,"By default, the cluster access configuration is stored in ${HOME}/.kube/config\nif $KUBECONFIG environment variable is not set."),(0,o.kt)("p",null,"If $KUBECONFIG environment variable is set, then it is used as a list of paths\n(normal path delimiting rules for your system). These paths are merged. When a value\nis modified, it is modified in the file that defines the stanza. When a value is created,\nit is created in the first file that exists. If no files in the chain exist,\nthen it creates the last file in the list."),(0,o.kt)("p",null,"You can use the ",(0,o.kt)("inlineCode",{parentName:"p"},"--kubeconfig")," flag when creating the cluster, then only that file is loaded.\nThe flag may only be set once and no merging takes place."),(0,o.kt)("p",null,"To see all the clusters you have created, you can use the ",(0,o.kt)("inlineCode",{parentName:"p"},"get clusters"),"\ncommand."),(0,o.kt)("p",null,"For example, let's say you create two clusters:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"kind create cluster # Default cluster context name is `kind`.\n...\nkind create cluster --name kind-2\n")),(0,o.kt)("p",null,"When you list your kind clusters, you will see something like the following:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"kind get clusters\nkind\nkind-2\n")),(0,o.kt)("p",null,"In order to interact with a specific cluster, you only need to specify the\ncluster name as a context in kubectl:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"kubectl cluster-info --context kind-kind\nkubectl cluster-info --context kind-kind-2\n")),(0,o.kt)("h3",{id:"deleting-a-cluster"},"Deleting a Cluster"),(0,o.kt)("p",null,"If you created a cluster with ",(0,o.kt)("inlineCode",{parentName:"p"},"kind create cluster")," then deleting is equally\nsimple:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"kind delete cluster\n")),(0,o.kt)("p",null,"If the flag ",(0,o.kt)("inlineCode",{parentName:"p"},"--name")," is not specified, kind will use the default cluster\ncontext name ",(0,o.kt)("inlineCode",{parentName:"p"},"kind")," and delete that cluster."),(0,o.kt)("h3",{id:"loading-an-image-into-your-cluster"},"Loading an Image Into Your Cluster"),(0,o.kt)("p",null,"Docker images can be loaded into your cluster nodes with:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kind load docker-image my-custom-image-0 my-custom-image-1\n")),(0,o.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},(0,o.kt)("strong",{parentName:"p"},"Note"),": If using a named cluster you will need to specify the name of the",(0,o.kt)("br",null),"\ncluster you wish to load the images into:",(0,o.kt)("br",null),"\n",(0,o.kt)("em",{parentName:"p"},"kind load docker-image my-custom-image-0 my-custom-image-1 --name kind-2")))),(0,o.kt)("p",null,"Additionally, image archives can be loaded with:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"kind load image-archive /my-image-archive.tar\n")),(0,o.kt)("p",null,"This allows a workflow like:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"docker build -t my-custom-image:unique-tag ./my-image-dir\nkind load docker-image my-custom-image:unique-tag\nkubectl apply -f my-manifest-using-my-image:unique-tag\n")),(0,o.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"\u4fe1\u606f")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},(0,o.kt)("strong",{parentName:"p"},"NOTE"),": You can get a list of images present on a cluster node by using docker exec:",(0,o.kt)("br",null),"\n",(0,o.kt)("em",{parentName:"p"},"docker exec -it my-node-name crictl images"),(0,o.kt)("br",null),"\nWhere ",(0,o.kt)("strong",{parentName:"p"},"my-node-name")," is the name of the Docker container (e.g. ",(0,o.kt)("strong",{parentName:"p"},"kind-control-plane"),")."))),(0,o.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"\u4fe1\u606f")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"}," ",(0,o.kt)("strong",{parentName:"p"},"NOTE"),": The Kubernetes default pull policy is ",(0,o.kt)("inlineCode",{parentName:"p"},"IfNotPresent")," unless",(0,o.kt)("br",null),"\nthe image tag is ",(0,o.kt)("inlineCode",{parentName:"p"},":latest")," or omitted (and implicitly ",(0,o.kt)("inlineCode",{parentName:"p"},":latest"),") in which case the default policy is ",(0,o.kt)("inlineCode",{parentName:"p"},"Always"),".\n",(0,o.kt)("inlineCode",{parentName:"p"},"IfNotPresent")," causes the Kubelet to skip pulling an image if it already exists.",(0,o.kt)("br",null),"\nSee ","[Kubernetes imagePullPolicy][Kubernetes imagePullPolicy]"," for more information."))),(0,o.kt)("p",null,"See also: ","[Using kind with Private Registries][Private Registries]","."),(0,o.kt)("h3",{id:"building-images"},"Building Images"),(0,o.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"\u4fe1\u606f")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},(0,o.kt)("strong",{parentName:"p"},"NOTE"),": If you're using Docker Desktop, be sure to read ",(0,o.kt)("a",{parentName:"p",href:"#settings-for-docker-desktop"},"Settings for Docker Desktop")," first."))),(0,o.kt)("p",null,'kind runs a local Kubernetes cluster by using Docker containers as "nodes".\nkind uses the ',"[",(0,o.kt)("inlineCode",{parentName:"p"},"node-image"),"][node image]"," to run Kubernetes artifacts, such\nas ",(0,o.kt)("inlineCode",{parentName:"p"},"kubeadm")," or ",(0,o.kt)("inlineCode",{parentName:"p"},"kubelet"),".\nThe ",(0,o.kt)("inlineCode",{parentName:"p"},"node-image")," in turn is built off the ","[",(0,o.kt)("inlineCode",{parentName:"p"},"base-image"),"][base image]",", which\ninstalls all the dependencies needed for Docker and Kubernetes to run in a\ncontainer."),(0,o.kt)("p",null,"Currently, kind supports one default way to build a ",(0,o.kt)("inlineCode",{parentName:"p"},"node-image"),"\nif you have the ","[Kubernetes][kubernetes]"," source in your host machine\n(",(0,o.kt)("inlineCode",{parentName:"p"},"$GOPATH/src/k8s.io/kubernetes"),"), by using ",(0,o.kt)("inlineCode",{parentName:"p"},"docker"),"."),(0,o.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"\u4fe1\u606f")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},(0,o.kt)("strong",{parentName:"p"},"NOTE"),": Building Kubernetes node-images requires everything building upstream",(0,o.kt)("br",null),"\nKubernetes requires, we wrap the upstream build. This includes Docker with buildx.",(0,o.kt)("br",null),"\nSee: ",(0,o.kt)("a",{parentName:"p",href:"https://git.k8s.io/community/contributors/devel/development.md#building-kubernetes-with-docker"},"https://git.k8s.io/community/contributors/devel/development.md#building-kubernetes-with-docker")))),(0,o.kt)("h3",{id:"settings-for-docker-desktop"},"Settings for Docker Desktop"),(0,o.kt)("p",null,"If you are building Kubernetes (for example - ",(0,o.kt)("inlineCode",{parentName:"p"},"kind build node-image"),") on MacOS or Windows then you need a minimum of 6GB of RAM\ndedicated to the virtual machine (VM) running the Docker engine. 8GB is recommended."),(0,o.kt)("p",null,"To change the resource limits for the Docker on Mac, you'll need to open the"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Preferences")," menu."),(0,o.kt)("img",{src:"https://d33wubrfki0l68.cloudfront.net/b6b566b3d35ab118ac6dd27c3732c5cab852365d/38c2b/docs/user/images/docker-pref-1.png"}),(0,o.kt)("p",null,"Now, go to the ",(0,o.kt)("strong",{parentName:"p"},"Advanced")," settings page, and change the\nsettings there, see ","[changing Docker's resource limits][Docker resource lims]","."),(0,o.kt)("img",{src:"https://d33wubrfki0l68.cloudfront.net/23353e57f81ecdd1485b2fb6db9489d2f635fd1e/1ad25/docs/user/images/docker-pref-2.png",alt:"Setting 8Gb of memory in Docker for Mac"}),(0,o.kt)("p",null,'To change the resource limits for the Docker on Windows, you\'ll need to right-click the Moby\nicon on the taskbar, and choose "Settings". If you see "Switch to Linux Containers", then you\'ll need\nto do that first before opening "Settings"'),(0,o.kt)("img",{src:"https://d33wubrfki0l68.cloudfront.net/6281a3188c95ce901ef98ce28c883c013fed8d7c/db170/docs/user/images/docker-pref-1-win.png"}),(0,o.kt)("p",null,"Now, go to the ",(0,o.kt)("strong",{parentName:"p"},"Advanced")," settings page, and change the\nsettings there, see ","[changing Docker's resource limits][Docker resource lims]","."),(0,o.kt)("img",{src:"https://d33wubrfki0l68.cloudfront.net/0be38be04913786e0cca3a4e0d3a3367f0c03bc1/86b0e/docs/user/images/docker-pref-build-win.png",alt:"Setting 8Gb of memory in Docker for Windows"}),(0,o.kt)("p",null,"You may also try removing any unused data left by the Docker engine - e.g.,\n",(0,o.kt)("inlineCode",{parentName:"p"},"docker system prune"),"."),(0,o.kt)("h3",{id:"advanced"},"Advanced"),(0,o.kt)("h4",{id:"configuring-your-kind-cluster"},"Configuring Your kind Cluster"),(0,o.kt)("p",null,"For a sample kind configuration file see ","[kind-example-config][kind-example-config]",".\nTo specify a configuration file when creating a cluster, use the ",(0,o.kt)("inlineCode",{parentName:"p"},"--config"),"\nflag:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kind create cluster --config kind-example-config.yaml\n")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Multi-node clusters")),(0,o.kt)("p",null,"In particular, many users may be interested in multi-node clusters. A simple\nconfiguration for this can be achieved with the following config file contents:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-yaml"},"# three node (two workers) cluster config\nkind: Cluster\napiVersion: kind.x-k8s.io/v1alpha4\nnodes:\n- role: control-plane\n- role: worker\n- role: worker\n")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Control-plane HA")),(0,o.kt)("p",null,"You can also have a cluster with multiple control-plane nodes:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-yaml"},"# a cluster with 3 control-plane nodes and 3 workers\nkind: Cluster\napiVersion: kind.x-k8s.io/v1alpha4\nnodes:\n- role: control-plane\n- role: control-plane\n- role: control-plane\n- role: worker\n- role: worker\n- role: worker\n")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Mapping ports to the host machine")),(0,o.kt)("p",null,"You can map extra ports from the nodes to the host machine with ",(0,o.kt)("inlineCode",{parentName:"p"},"extraPortMappings"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-yaml"},'kind: Cluster\napiVersion: kind.x-k8s.io/v1alpha4\nnodes:\n- role: control-plane\n  extraPortMappings:\n  - containerPort: 80\n    hostPort: 80\n    listenAddress: "0.0.0.0" # Optional, defaults to "0.0.0.0"\n    protocol: udp # Optional, defaults to tcp\n')),(0,o.kt)("p",null,"This can be useful if using ",(0,o.kt)("inlineCode",{parentName:"p"},"NodePort")," services or daemonsets exposing host ports."),(0,o.kt)("p",null,"Note: binding the ",(0,o.kt)("inlineCode",{parentName:"p"},"listenAddress")," to ",(0,o.kt)("inlineCode",{parentName:"p"},"127.0.0.1")," may affect your ability to access the service."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Setting Kubernetes version")),(0,o.kt)("p",null,"You can also set a specific Kubernetes version by setting the ",(0,o.kt)("inlineCode",{parentName:"p"},"node"),"'s container image. You can find available image tags on the ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/kubernetes-sigs/kind/releases"},"releases page"),". Please use the ",(0,o.kt)("inlineCode",{parentName:"p"},"sha256")," shasum for your desired kubernetes version, as seen in this example:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-yaml"},"kind: Cluster\napiVersion: kind.x-k8s.io/v1alpha4\nnodes:\n- role: control-plane\n  image: kindest/node:v1.16.4@sha256:b91a2c2317a000f3a783489dfb755064177dbc3a0b2f4147d50f04825d016f55\n- role: worker\n  image: kindest/node:v1.16.4@sha256:b91a2c2317a000f3a783489dfb755064177dbc3a0b2f4147d50f04825d016f55\n")),(0,o.kt)("h4",{id:"enable-feature-gates-in-your-cluster"},"Enable Feature Gates in Your Cluster"),(0,o.kt)("p",null,"Feature gates are a set of key=value pairs that describe alpha or experimental features. In order to enable a gate you have to ","[customize your kubeadm configuration][customize control plane with kubeadm]",", and it will depend on what gate and component you want to enable. An example kind config can be:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-yaml"},"kind: Cluster\napiVersion: kind.x-k8s.io/v1alpha4\nfeatureGates:\n  FeatureGateName: true\n")),(0,o.kt)("h3",{id:"configure-kind-to-use-a-proxy"},"Configure kind to use a proxy"),(0,o.kt)("p",null,"If you are running kind in an environment that requires a proxy, you may need to configure kind to use it."),(0,o.kt)("p",null,"You can configure kind to use a proxy using one or more of the following ","[environment variables][proxy environment variables]"," (uppercase takes precedence):"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"HTTP_PROXY")," or ",(0,o.kt)("inlineCode",{parentName:"li"},"http_proxy")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"HTTPS_PROXY")," or ",(0,o.kt)("inlineCode",{parentName:"li"},"https_proxy")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"NO_PROXY")," or ",(0,o.kt)("inlineCode",{parentName:"li"},"no_proxy"))),(0,o.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"\u4fe1\u606f")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},(0,o.kt)("strong",{parentName:"p"},"NOTE"),": If you set a proxy it would be passed along to everything in the kind nodes. ",(0,o.kt)("inlineCode",{parentName:"p"},"kind")," will automatically append certain addresses into ",(0,o.kt)("inlineCode",{parentName:"p"},"NO_PROXY")," before passing it to the nodes so that Kubernetes components connect to each other directly, but you may need to configure\nadditional addresses depending on your usage."))),(0,o.kt)("h3",{id:"exporting-cluster-logs"},"Exporting Cluster Logs"),(0,o.kt)("p",null,"kind has the ability to export all kind related logs for you to explore.\nTo export all logs from the default cluster (context name ",(0,o.kt)("inlineCode",{parentName:"p"},"kind"),"):"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kind export logs\nExported logs to: /tmp/396758314\n")),(0,o.kt)("p",null,"Like all other commands, if you want to perform the action on a cluster with a\ndifferent context name use the ",(0,o.kt)("inlineCode",{parentName:"p"},"--name")," flag."),(0,o.kt)("p",null,"As you can see, kind placed all the logs for the cluster ",(0,o.kt)("inlineCode",{parentName:"p"},"kind")," in a\ntemporary directory. If you want to specify a location then simply add the path\nto the directory after the command:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kind export logs ./somedir\nExported logs to: ./somedir\n")),(0,o.kt)("p",null,"The structure of the logs will look more or less like this:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},".\n\u251c\u2500\u2500 docker-info.txt\n\u2514\u2500\u2500 kind-control-plane/\n    \u251c\u2500\u2500 containers\n    \u251c\u2500\u2500 docker.log\n    \u251c\u2500\u2500 inspect.json\n    \u251c\u2500\u2500 journal.log\n    \u251c\u2500\u2500 kubelet.log\n    \u251c\u2500\u2500 kubernetes-version.txt\n    \u2514\u2500\u2500 pods/\n")),(0,o.kt)("p",null,"The logs contain information about the Docker host, the containers running\nkind, the Kubernetes cluster itself, etc."),(0,o.kt)("h3",{id:"reference"},"reference"),(0,o.kt)("p",null,"[go-supported]","\n",(0,o.kt)("a",{parentName:"p",href:"https://golang.org/doc/devel/release.html#policy"},"https://golang.org/doc/devel/release.html#policy"),")"),(0,o.kt)("p",null,"[releases]","\n",(0,o.kt)("a",{parentName:"p",href:"https://github.com/kubernetes-sigs/kind/releases"},"https://github.com/kubernetes-sigs/kind/releases")),(0,o.kt)("p",null,"[kind-example-config]","\n",(0,o.kt)("a",{parentName:"p",href:"https://raw.githubusercontent.com/kubernetes-sigs/kind/main/site/content/docs/user/kind-example-config.yaml"},"https://raw.githubusercontent.com/kubernetes-sigs/kind/main/site/content/docs/user/kind-example-config.yaml")),(0,o.kt)("p",null,"[kubernetes]","\n",(0,o.kt)("a",{parentName:"p",href:"https://github.com/kubernetes/kubernetes"},"https://github.com/kubernetes/kubernetes")),(0,o.kt)("p",null,"[kindest/node]","\n",(0,o.kt)("a",{parentName:"p",href:"https://hub.docker.com/r/kindest/node/"},"https://hub.docker.com/r/kindest/node/")),(0,o.kt)("p",null,"[kubectl]","\n",(0,o.kt)("a",{parentName:"p",href:"https://kubernetes.io/docs/reference/kubectl/overview/"},"https://kubernetes.io/docs/reference/kubectl/overview/")),(0,o.kt)("p",null,"[Docker resource lims]","\n",(0,o.kt)("a",{parentName:"p",href:"https://docs.docker.com/docker-for-mac/#advanced"},"https://docs.docker.com/docker-for-mac/#advanced")),(0,o.kt)("p",null,"[install docker]","\n",(0,o.kt)("a",{parentName:"p",href:"https://docs.docker.com/install/"},"https://docs.docker.com/install/")),(0,o.kt)("p",null,"[proxy environment variables]","\n",(0,o.kt)("a",{parentName:"p",href:"https://docs.docker.com/network/proxy/#use-environment-variables"},"https://docs.docker.com/network/proxy/#use-environment-variables")),(0,o.kt)("p",null,"[CGO]","\n",(0,o.kt)("a",{parentName:"p",href:"https://golang.org/cmd/cgo/"},"https://golang.org/cmd/cgo/")),(0,o.kt)("p",null,"[Kubernetes imagePullPolicy]","\n",(0,o.kt)("a",{parentName:"p",href:"https://kubernetes.io/docs/concepts/containers/images/#updating-images"},"https://kubernetes.io/docs/concepts/containers/images/#updating-images")),(0,o.kt)("p",null,"[customize control plane with kubeadm]","\n",(0,o.kt)("a",{parentName:"p",href:"https://kubernetes.io/docs/setup/independent/control-plane-flags/"},"https://kubernetes.io/docs/setup/independent/control-plane-flags/")),(0,o.kt)("p",null,"[access multiple clusters]","\n",(0,o.kt)("a",{parentName:"p",href:"https://kubernetes.io/docs/tasks/access-application-cluster/configure-access-multiple-clusters/"},"https://kubernetes.io/docs/tasks/access-application-cluster/configure-access-multiple-clusters/")),(0,o.kt)("p",null,"[release notes]","\n",(0,o.kt)("a",{parentName:"p",href:"https://github.com/kubernetes-sigs/kind/releases"},"https://github.com/kubernetes-sigs/kind/releases")))}m.isMDXComponent=!0}}]);